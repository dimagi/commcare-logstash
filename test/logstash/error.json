{
    "codec": "line",
    "fields": {
      "type": "nginx-error"
    },
    "ignore": [
      "host"
    ],
    "testcases": [
      {
        "description": " General Error",
        "input": [
            "2020/01/29 08:18:05 [error] 110579#110579: *23672990 limiting requests, excess: 50.090 by zone \"app_downloads\", client: 223.188.118.33, server: cas.commcarehq.org, request: \"GET /a/icds-cas/apps/download/66d132d12f1e4c16a12870b0746e06ac/media_profile.ccpr?latest=true&profile=ce8ef933c7754fdcaabfa8a469b7e1b9&username=08130080411 HTTP/2.0\", host: \"cas.commcarehq.org\""
        ],
        "expected": [
          {
            "type": "nginx-error",
            "@timestamp": "2020-01-29T08:18:05.000Z",
            "http_timestamp": "2020/01/29 08:18:05",
            "verb": "GET",
            "err_severity": "error",
            "err_message": "limiting requests, excess: 50.090 by zone \"app_downloads\"",
            "domain": "icds-cas",
            "clientip": "223.188.118.33",
            "server": "cas.commcarehq.org"
          }
        ]
      }
    ]
}
